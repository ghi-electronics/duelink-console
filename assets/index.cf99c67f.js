var e=Object.defineProperty,t=(t,a,l)=>(((t,a,l)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l})(t,"symbol"!=typeof a?a+"":a,l),l);import{r as a,w as l,c as s,n,a as i,o,b as r,d as c,e as d,f as u,g as p,h as f,F as h,i as v,j as m,k as g,l as b,t as y,m as w,p as k,q as x,s as C,u as E,v as _,x as M,y as O,z as D,A as L,U as S,Y as T,B as R,S as z,E as A,C as B,D as U,G as F,H as I,I as P,J as j,K as $,V as N,L as K,M as X,N as H,O as q,P as W,Q as V,R as G,T as Y}from"./vendor.7d0d28b3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const J=new Worker(new URL("./assets/worker.a3f829ed.js",window.location));function Q(e,t){const s=a([]),n=a(!1),i=a(!1),o=a(!1),r=a(!0),c=a(!1),d=a(""),u=a([]),p=a(null);let f=null,h=0;const v={};function m(e=!1){e&&(f=()=>t.emit("regionSelected")),J.postMessage({task:"memoryRegions"})}function g(e){s.value.push({date:new Date,error:e})}function b(e){s.value.push({date:new Date,event:e})}function y(e){let t=null;return e&&(t=++h,v[t]=e),t}return J.addEventListener("message",(a=>function(a){var l,s;switch(a.event){case"connected":n.value=!1,i.value=!0,b("Port connected."),m(!0);break;case"disconnected":i.value=!1,b("Port disconnected.");break;case"erased":u.value=[],t.emit("erased");break;case"isTalking":c.value=a.value,null==(s=null==(l=null==a?void 0:a.lastCommand)?void 0:l.startsWith)||s.call(l,"region");break;case"listAllResult":t.emit("listAllResult",a);break;case"logError":g(a.message),a.message.toLowerCase().indexOf("port")>-1&&(n.value=!1);break;case"logEvent":b(a.message);break;case"memoryRegionsResult":u.value=[],a.result.shift(),a.result.forEach((e=>{if(e){const t=(e=e.match(/(\*?\d+)/gm))[0].startsWith("*");t&&(e[0]=e[0].substring(1,e[0].length)),u.value.push({current:t,index:Number(e[0]),used:Number(e[1]),total:Number(e[2])})}})),f&&(f(),f=null);break;case"output":d.value=a.value;break;case"playing":r.value=!1,o.value=!0,b("Program started.");break;case"recording":o.value=!1,r.value=!0,0===a.percent?(e.progress.style.width="0",e.progress.classList.remove("opacity-0")):e.progress.style.width=Math.trunc(a.percent)+"%";break;case"recorded":e.progress.style.width="100%",e.progress.classList.add("opacity-0"),m();break;case"regionSelected":u.value.forEach((e=>e.current=e.index===a.index)),m(!0);break;case"stopped":o.value=!1,r.value=!0,b("Program stopped.");break;case"version":p.value=a.value;break;case"writeResult":v[a.callbackId]&&(v[a.callbackId](a.result),delete v[a.callbackId]);break;case"ConnectFailed":const h=a.message.indexOf(":");let y=a.message;-1!==h&&(y=a.message.substring(0,h)),alert(y)}}(a.data))),J.addEventListener("error",(e=>{J.terminate()})),l((()=>d.value),(e=>{""===e&&J.postMessage({task:"clearOutput"})})),{history:s,isBusy:n,isConnected:i,isPlaying:o,isStopped:r,isTalking:c,log:d,regions:u,version:p,connect:async function(){!window.document.documentMode&&navigator.serial||(window.location="/browser-not-supported.html"),n.value=!0;try{await navigator.serial.requestPort({usbVendorId:7071})}catch(e){return g((null==e?void 0:e.message)||"Unable to request port."),void(n.value=!1)}J.postMessage({task:"connect"})},disconnect:async function(){J.postMessage({task:"disconnect"})},execute:function(e){J.postMessage({task:"execute",line:e})},list:function(e=null){J.postMessage({task:"list",callbackId:y(e)})},listAll:function(){J.postMessage({task:"listAll"})},newAll:function(){J.postMessage({task:"newAll"})},play:function(){J.postMessage({task:"play"})},record:function(e){J.postMessage({task:"record",lines:e})},region:function(e){J.postMessage({task:"region",index:e})},stop:function(){J.postMessage({task:"stop"})}}}const Z=["id"],ee=["id"],te={key:0,class:"ml-2 fas fa-fw fa-external-link"},ae={props:{id:{type:String,required:!0},options:{type:Array,required:!0}},setup(e){const t=e;let M=null,O=null,D=null;const L=a(!1),S=s((()=>({"aria-orientation":!!t.id&&"vertical","aria-labelledby":!!t.id&&`${t.id}-menu`})));return l((()=>L.value),(e=>{n((()=>{e?M=i(D,O,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}},{name:"preventOverflow",options:{padding:16}}],strategy:"fixed"}):M&&(M.destroy(),M=null)}))})),o((()=>{O=document.getElementById(`menu-${t.id}`),D=document.getElementById(`menu-${t.id}-btn`)})),(t,a)=>{const l=r("click-outside");return c((d(),u("div",null,[p("div",{id:`menu-${e.id}-btn`,class:"inline-flex rounded a",onClick:a[0]||(a[0]=e=>L.value=!L.value)},[f(t.$slots,"default")],8,Z),c(p("div",C(E(S),{id:`menu-${e.id}`,class:"min-w-[100px] border rounded shadow-lg z-10 bg-slate-50 border-slate-300 dark:bg-zinc-700 dark:border-zinc-600",role:"menu"}),[(d(!0),u(h,null,v(e.options,(e=>(d(),m(x((null==e?void 0:e.href)?"a":"div"),{href:(null==e?void 0:e.href)?e.href:void 0,key:e.label,class:"w-full px-4 py-1 text-slate-900 dark:text-zinc-100 hover:bg-slate-200 dark:hover:bg-zinc-600 cursor-pointer",onClick:k((t=>{e.click(),L.value=!1}),["prevent"])},{default:g((()=>[b(y(e.label)+" ",1),(null==e?void 0:e.href)?(d(),u("i",te)):w("",!0)])),_:2},1032,["href","onClick"])))),128))],16,ee),[[_,L.value]])],512)),[[l,()=>L.value=!1]])}}},le={props:{type:{type:String,default:"primary"}},setup:e=>(t,a)=>(d(),u("button",{class:M(["btn",e.type]),type:"button"},[f(t.$slots,"default")],2))},se={id:"menu-bar",class:"p-2 flex items-center space-x-8"},ne=p("div",{class:"flex items-center space-x-2"},[p("svg",{id:"logo",class:"h-6 w-auto",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1200 266",preserveAspectRatio:"xMidYMid meet","aria-hidden":"true",style:{display:"block",transform:"scale(1,-1)"}},[p("g",{transform:"translate(0, 400) scale(1, -1) rotate(0 0 0)",fill:"currentColor",stroke:"none"},[p("path",{d:"M1132.1,156.6H643.8c0,0,0-0.1,0-0.1H137c-28.8,59.1-38.2,119.4-23.4,181.1l103.8,0\n\t\t\t\tc71.1,0,87.3-132.9-0.2-118.4l-16.7,81.5l-39.4,0.2l21-109.1l2.3-0.6c195-39.1,160.1,179.8,29.1,179.4l-89.5,0.3\n\t\t\t\tc3.7,9.8,8,19.6,13,29.4h506.7c0-0.1,0.1-0.2,0.1-0.3h486.7c19.4-37,30.4-78.9,30.4-123.2C1161,233.7,1150.6,192.9,1132.1,156.6z\n\t\t\t\t M477.3,313.7c-15.6,82.2-149.3,72.5-137.2-0.5l20.6-124h40.5l-19.3,103.4c-11.2,60.1,50.4,60.4,59.6,11.8l21.9-115.2H501\n\t\t\t\tL477.3,313.7z M617.9,334.3l-7.5,34.7H501l21.1-109.4h102.3l-6.8,32.9h-62.9l-8.4,41.8H617.9z M672,223.5H528.4l6.8-34.3\n\t\t\t\tl143.2-0.2L672,223.5z M779.5,371.3h-98.9L712,189.1h35.3l-25.5,148.1h63.6L779.5,371.3z M833.9,371.3h-35.3l22.8-132.2h35.3\n\t\t\t\tL833.9,371.3z M843.5,222.7h-0.2c-9.6,0-16.9-7.3-16.9-18.9c0.2-13.2,9.6-22.2,20.4-22.2c10.3,0,17.7,7.6,17.7,19.2\n\t\t\t\tC864.4,214.5,854.8,222.7,843.5,222.7z M985.6,294.6l-13.3,76.8H937l12.5-73.3c0.7-4.6,1.2-10,1.2-14.9c0-9.2-2.9-15.7-11.8-15.7\n\t\t\t\tc-11.5,0-25,15.9-29.9,45.1L899,371.3h-35.3l15.2-89.2c2.9-16.8,4.9-31.4,6.4-43h31.4l-2.5,21.9h0.5\n\t\t\t\tc11.3-17.3,26.3-24.9,42.2-24.9c19.6,0,30.7,13.2,30.7,36C987.6,278.1,986.6,288.1,985.6,294.6z M1117.9,371.3h-39.3l-21.1-56.5\n\t\t\t\tl-13.3,14.1l-7.4,42.4h-35.1l32.9-191.9h35.1l-19.6,114.9h0.5c3.7-5.1,7.4-10.3,10.8-15.1l30.7-40h43.4l-51,54.3L1117.9,371.3z"})])])],-1),ie={class:"flex items-center space-x-4"},oe=p("a",{href:"https://duelink.com",target:"_blank"},"Docs",-1),re=b("Demos"),ce=["data-tippy-content","onClick"],de={props:{theme:String},emits:["demo","firmware","dfu","update:theme","updateTippy"],setup(e,{emit:t}){const l=e,s=a([]);function n(e){"dark"===l.theme?(t("update:theme","light"),localStorage.theme="light",document.documentElement.style.colorScheme="light",document.documentElement.classList.remove("dark")):(t("update:theme","dark"),localStorage.theme="dark",document.documentElement.style.colorScheme="dark",document.documentElement.classList.add("dark")),t("updateTippy",e.target,!0)}return async function(){try{const e=await fetch("/demos.json"),a=await e.json();s.value=a.map((e=>(null==e?void 0:e.url)?{label:e.label,click:()=>window.open(e.url,"_blank"),href:e.url}:{label:e.label,click:()=>t("demo",e.code)}))}catch(e){}}(),(a,l)=>(d(),u("div",se,[ne,p("div",ie,[oe,O(ae,{options:s.value,id:"demo"},{default:g((()=>[re])),_:1},8,["options"]),p("a",{onClick:l[0]||(l[0]=k((e=>t("dfu")),["prevent"]))},"Firmware"),p("a",{onClick:l[1]||(l[1]=k((e=>t("firmware")),["prevent"]))},"(Legacy)"),p("a",{class:"text-sm","data-tippy-content":"dark"===e.theme?"Light":"Dark",onClick:k(n,["prevent"])},[p("i",{class:M(["dark"===e.theme?"fa-sun":"fa-moon","fas fa-fw pointer-events-none"])},null,2)],8,ce)])]))}},ue={id:"tool-bar",class:"p-2 flex items-center space-x-2 overflow-x-auto"},pe=p("i",{class:"fas fa-fw fa-circle"},null,-1),fe=p("i",{class:"fas fa-fw fa-play"},null,-1),he=p("i",{class:"fas fa-fw fa-square"},null,-1),ve=p("i",{class:"fas fa-fw fa-list"},null,-1),me=p("i",{class:"fas fa-fw fa-download"},null,-1),ge={class:"btn primary tool text-center cursor-pointer","data-tippy-content":"Load",for:"file"},be=p("i",{class:"fas fa-fw fa-upload"},null,-1),ye=p("i",{class:"fas fa-fw fa-magnifying-glass-plus"},null,-1),we=p("i",{class:"fas fa-fw fa-magnifying-glass-minus"},null,-1),ke={props:{canDownload:Boolean,canList:Boolean,canLoad:Boolean,canPlay:Boolean,canRecord:Boolean,canStop:Boolean,canTextSizePlus:Boolean,canTextSizeMinus:Boolean,isBusy:Boolean,isConnected:Boolean,isTalking:Boolean},emits:["connect","disconnect","download","play","stop","record","list","load"],setup(e,{emit:t}){const a=e;function l(e){if(!e.target.files.length)return;const a=new FileReader;a.onload=function(){t("load",a.result.replace(/\r/gm,"").replace(/\t/gm," ").split("\n")),e.target.value=""},a.readAsText(e.target.files[0])}function s(){a.isConnected?t("disconnect"):t("connect")}return(a,n)=>(d(),u("div",ue,[O(le,{id:"plugBtn",class:M(["tool",e.isConnected?"connected":""]),"data-tippy-content":e.isConnected?"Disconnect":"Connect",onClick:s},{default:g((()=>[p("i",{class:M([e.isConnected?"fa-plug-circle-xmark":"fa-plug","fas fa-fw"])},null,2)])),_:1},8,["class","data-tippy-content"]),O(le,{disabled:e.isBusy||!e.isConnected||e.isTalking||!e.canRecord,class:"tool record","data-tippy-content":"Record",onClick:n[0]||(n[0]=e=>t("record"))},{default:g((()=>[pe])),_:1},8,["disabled"]),O(le,{disabled:e.isBusy||!e.isConnected||e.isTalking||!e.canPlay,class:"tool play","data-tippy-content":"Play",onClick:n[1]||(n[1]=e=>t("play"))},{default:g((()=>[fe])),_:1},8,["disabled"]),O(le,{disabled:e.isBusy||!e.isConnected||!e.canStop,class:"tool stop","data-tippy-content":"Stop",onClick:n[2]||(n[2]=e=>t("stop"))},{default:g((()=>[he])),_:1},8,["disabled"]),O(le,{disabled:e.isBusy||!e.isConnected||e.isTalking||!e.canList,class:"tool","data-tippy-content":"List",onClick:n[3]||(n[3]=e=>t("list",e.target))},{default:g((()=>[ve])),_:1},8,["disabled"]),O(le,{disabled:!e.canDownload,class:"tool","data-tippy-content":"Download",onClick:n[4]||(n[4]=e=>t("download"))},{default:g((()=>[me])),_:1},8,["disabled"]),p("label",ge,[be,p("input",{id:"file",type:"file",class:"hidden",onChange:l},null,32)]),O(le,{disabled:!e.canTextSizePlus,class:"tool","data-tippy-content":"Increase text size",onClick:n[5]||(n[5]=e=>t("text-size-plus"))},{default:g((()=>[ye])),_:1},8,["disabled"]),O(le,{disabled:!e.canTextSizeMinus,class:"tool","data-tippy-content":"Decrease text size",onClick:n[6]||(n[6]=e=>t("text-size-minus"))},{default:g((()=>[we])),_:1},8,["disabled"])]))}},xe={},Ce={id:"footer",class:"p-2 sm:p-4 flex flex-col space-y-2"},Ee={class:"flex items-center justify-center space-x-8 sm:space-x-0 sm:justify-between"},_e=D('<a href="https://ghielectronics.com" target="_blank"><svg class="h-8 w-auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 706 297" preserveAspectRatio="xMidYMid meet" aria-hidden="true"><g transform="translate(0, 297) scale(0.1, -0.1)" fill="currentColor" stroke="none"><path d="M850 2961 c-62 -7 -94 -22 -106 -48 -5 -10 -9 -90 -9 -178 l0 -160 -34 -70 c-44 -88 -154 -200 -238 -241 -57 -29 -61 -29 -213 -27 -177 3 -226 -6 -240 -43 -13 -34 -12 -360 1 -407 16 -57 48 -67 218 -67 108 0 153 -4 200 -19 122 -38 203 -107 262 -223 32 -62 33 -66 39 -238 6 -182 12 -210 53 -232 27 -15 399 -13 428 2 36 20 43 52 47 203 5 176 -2 228 -32 264 -23 27 -25 27 -192 34 -185 8 -204 12 -294 60 -228 121 -301 454 -152 685 45 70 115 134 180 166 41 20 69 23 221 30 96 4 187 12 203 19 47 19 59 57 65 198 7 161 -1 233 -32 269 -23 27 -23 27 -172 28 -81 1 -173 -1 -203 -5z"></path><path d="M1515 2961 c-40 -17 -43 -31 -47 -221 l-3 -185 -38 -72 c-48 -90 -125 -164 -213 -205 -63 -30 -74 -31 -247 -39 -175 -8 -182 -9 -207 -34 l-25 -25 0 -200 0 -199 28 -28 27 -28 153 -1 c90 0 170 -6 197 -13 184 -53 297 -191 330 -408 31 -197 -81 -399 -270 -490 -67 -33 -85 -37 -176 -41 -84 -4 -114 -1 -172 17 -132 40 -247 138 -306 261 -31 65 -31 66 -31 232 l0 167 -28 28 -27 28 -205 0 c-272 0 -250 22 -250 -250 l0 -205 25 -25 c34 -33 100 -41 206 -25 94 15 153 7 233 -32 60 -29 162 -127 216 -208 l45 -68 1 -158 c1 -266 0 -266 291 -262 174 3 199 5 215 21 16 16 18 39 18 200 0 182 0 182 30 242 40 81 152 193 230 230 59 29 64 29 231 30 187 1 214 8 235 63 6 15 9 103 7 214 -4 247 11 231 -221 239 -109 4 -189 12 -219 22 -158 50 -249 168 -284 369 -41 234 23 385 213 509 l67 44 116 3 c79 3 136 -1 183 -12 248 -58 394 -260 372 -515 -13 -152 -7 -171 62 -197 38 -15 68 -16 216 -10 186 7 211 14 224 64 4 15 8 101 8 192 0 259 -2 261 -247 257 l-163 -2 -60 30 c-69 35 -190 150 -232 222 -27 47 -28 52 -33 240 -7 257 14 237 -253 240 -111 1 -211 -2 -222 -6z"></path><path d="M3540 2879 c-177 -23 -317 -116 -390 -260 -65 -127 -65 -127 -65 -649 l0 -475 27 -80 c63 -184 173 -289 354 -335 72 -19 112 -20 626 -20 l548 0 -2 538 -3 537 -387 3 -388 2 0 -200 0 -200 195 0 195 0 0 -145 0 -145 -320 0 c-348 0 -361 2 -412 56 -15 16 -32 42 -37 57 -7 18 -11 164 -11 408 0 401 2 422 48 472 47 52 42 52 567 57 l490 5 0 190 0 190 -485 1 c-267 1 -514 -2 -550 -7z"></path><path d="M4787 2884 c-4 -4 -7 -416 -7 -916 l0 -908 225 0 225 0 0 390 0 390 385 0 385 0 0 -390 0 -390 220 0 220 0 -2 913 -3 912 -217 3 -218 2 0 -365 0 -365 -385 0 -385 0 -2 363 -3 362 -216 3 c-118 1 -218 -1 -222 -4z"></path><path d="M6610 2618 l0 -273 215 215 215 215 0 57 0 58 -215 0 -215 0 0 -272z"></path><path d="M6822 2427 l-212 -212 0 -578 0 -577 215 0 215 0 0 790 c0 435 -1 790 -3 790 -1 0 -98 -96 -215 -213z"></path><path d="M1560 2229 c-81 -16 -85 -25 -88 -223 -5 -264 0 -270 223 -281 168 -8 249 -28 325 -83 127 -91 212 -286 197 -450 -16 -164 -179 -359 -341 -407 -40 -12 -79 -14 -186 -9 -151 8 -192 -3 -210 -52 -6 -14 -10 -109 -10 -210 l0 -186 30 -29 30 -30 210 3 c202 3 210 4 232 26 21 21 22 29 18 110 -10 202 -6 243 28 315 38 82 112 162 210 228 l74 49 174 0 c182 0 223 8 238 45 11 30 7 392 -5 418 -18 39 -50 47 -194 47 -74 0 -158 5 -187 11 -114 24 -212 89 -266 178 -52 84 -63 133 -71 306 -8 182 -17 207 -80 225 -43 12 -288 11 -351 -1z"></path><path d="M6110 865 c0 -33 2 -35 35 -35 33 0 35 2 35 35 0 33 -2 35 -35 35 -33 0 -35 -2 -35 -35z"></path><path d="M3590 625 l0 -265 35 0 35 0 0 265 0 265 -35 0 -35 0 0 -265z"></path><path d="M4668 785 c-11 -40 -15 -45 -40 -45 -24 0 -28 -4 -28 -30 0 -25 4 -30 24 -30 l24 0 4 -141 c3 -140 3 -141 31 -165 45 -39 137 -31 137 12 0 21 -5 24 -35 24 -48 0 -55 19 -55 154 l0 116 45 0 c43 0 45 1 45 30 0 29 -2 30 -45 30 l-45 0 0 45 c0 41 -2 45 -25 45 -21 0 -27 -7 -37 -45z"></path><path d="M3227 726 c-80 -29 -111 -80 -111 -181 1 -104 38 -162 119 -184 85 -23 162 -6 215 47 l35 36 -35 7 c-28 6 -39 4 -57 -13 -16 -15 -40 -23 -77 -26 -51 -4 -57 -2 -86 26 -20 21 -30 40 -30 61 l0 31 145 0 c164 0 158 -3 134 83 -28 103 -139 153 -252 113z m136 -58 c28 -15 46 -38 47 -60 0 -16 -12 -18 -105 -18 -97 0 -105 2 -105 19 0 11 14 31 31 45 34 29 93 35 132 14z"></path><path d="M3867 726 c-80 -29 -111 -80 -111 -181 1 -104 38 -162 119 -184 85 -23 162 -6 215 47 l35 36 -35 7 c-28 6 -39 4 -57 -13 -16 -15 -40 -23 -77 -26 -51 -4 -57 -2 -86 26 -20 21 -30 40 -30 61 l0 31 145 0 c164 0 158 -3 134 83 -28 103 -139 153 -252 113z m136 -58 c28 -15 46 -38 47 -60 0 -16 -12 -18 -105 -18 -97 0 -105 2 -105 19 0 11 14 31 31 45 34 29 93 35 132 14z"></path><path d="M4305 725 c-84 -29 -127 -128 -104 -235 23 -108 124 -162 241 -130 48 14 93 52 107 90 10 30 9 30 -25 30 -27 0 -43 -8 -68 -35 -28 -29 -40 -35 -75 -35 -33 0 -49 6 -71 28 -53 53 -49 178 7 221 43 35 135 22 148 -21 5 -13 16 -18 46 -18 49 0 51 16 8 64 -47 54 -131 70 -214 41z"></path><path d="M4900 550 l0 -190 34 0 33 0 5 118 c7 158 30 202 107 202 28 0 31 3 31 31 0 31 0 32 -42 26 -41 -5 -55 -16 -85 -63 -10 -16 -12 -13 -12 24 -1 41 -2 42 -36 42 l-35 0 0 -190z"></path><path d="M5281 728 c-83 -23 -124 -84 -125 -183 0 -125 69 -190 200 -190 60 1 78 5 111 27 94 62 109 224 29 304 -49 49 -134 66 -215 42z m148 -76 c19 -18 30 -43 35 -73 7 -45 5 -55 -16 -112 -28 -74 -163 -75 -196 -2 -16 34 -15 134 2 164 18 33 53 50 104 51 35 0 49 -6 71 -28z"></path><path d="M5640 550 l0 -190 34 0 34 0 4 118 c5 129 18 170 63 190 62 28 118 5 135 -56 5 -20 10 -85 10 -144 l0 -108 36 0 35 0 -3 154 -3 155 -29 30 c-53 55 -154 53 -212 -6 l-34 -34 0 41 c0 39 -1 40 -35 40 l-35 0 0 -190z"></path><path d="M6110 550 l0 -190 35 0 35 0 0 190 0 190 -35 0 -35 0 0 -190z"></path><path d="M6385 725 c-84 -29 -127 -128 -104 -235 23 -108 124 -162 241 -130 48 14 93 52 107 90 10 30 9 30 -25 30 -27 0 -43 -8 -68 -35 -28 -29 -40 -35 -75 -35 -33 0 -49 6 -71 28 -53 53 -49 178 7 221 43 35 135 22 148 -21 5 -13 16 -18 46 -18 49 0 51 16 8 64 -47 54 -131 70 -214 41z"></path><path d="M6785 725 c-22 -8 -41 -15 -42 -15 -9 0 -33 -64 -33 -88 0 -53 46 -85 150 -104 66 -11 100 -31 100 -58 0 -60 -153 -70 -195 -13 -8 11 -19 12 -44 6 l-32 -8 23 -35 c36 -53 127 -73 224 -49 106 27 128 146 36 193 -15 8 -54 19 -87 26 -99 20 -130 51 -83 84 35 25 104 21 132 -7 18 -18 32 -23 55 -19 17 2 31 6 31 8 0 19 -30 59 -54 71 -43 22 -133 26 -181 8z"></path></g></svg></a>',1),Me={class:"hidden text-center sm:block"},Oe=D('<div class="text-4xl flex space-x-4"><a href="https://www.facebook.com/ghielectronics/" target="_blank"><i class="fab fa-facebook-square"></i></a><a href="https://www.twitter.com/GHIElectronics" target="_blank"><i class="fab fa-twitter-square"></i></a><a href="https://www.youtube.com/user/GHIElectronics" target="_blank"><i class="fab fa-youtube-square"></i></a><a href="https://www.linkedin.com/company/ghielectronics/" target="_blank"><i class="fab fa-linkedin"></i></a></div>',1),De={class:"text-center text-sm sm:hidden"};xe.render=function(e,t){return d(),u("div",Ce,[p("div",Ee,[_e,p("div",Me," © GHI Electronics "+y((new Date).getFullYear()),1),Oe]),p("div",De," © GHI Electronics "+y((new Date).getFullYear()),1)])};const Le=p("div",{class:"fixed inset-0 bg-slate-500 dark:bg-black bg-opacity-75 dark:bg-opacity-75 transition-opacity"},null,-1),Se={class:"fixed inset-0 z-10 overflow-y-auto"},Te={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Re={class:"mt-2"},ze={class:"mt-5 sm:mt-6"},Ae={props:{open:Boolean,maxWidthClass:{type:String,default:"sm:max-w-sm"}},setup:e=>(t,a)=>(d(),m(E(z),{as:"template",show:e.open},{default:g((()=>[O(E(R),{as:"div",class:"relative z-10",onClose:a[0]||(a[0]=t=>e.open=!1)},{default:g((()=>[O(E(L),{as:"template",enter:"ease-out duration-150","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-150","leave-from":"opacity-100","leave-to":"opacity-0"},{default:g((()=>[Le])),_:1}),p("div",Se,[p("div",Te,[O(E(L),{as:"template",enter:"ease-out duration-150","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-150","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:g((()=>[O(E(S),{class:M([e.maxWidthClass,"relative transform overflow-hidden rounded-lg bg-white dark:bg-zinc-800 px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:p-6 sm:w-full"])},{default:g((()=>[p("div",null,[O(E(T),{as:"h3",class:"text-base font-semibold leading-6 text-sky-600 dark:text-lime-300"},{default:g((()=>[f(t.$slots,"title")])),_:3}),p("div",Re,[f(t.$slots,"default")])]),p("div",ze,[f(t.$slots,"buttons")])])),_:3},8,["class"])])),_:3})])])])),_:3})])),_:3},8,["show"]))};var Be={};
/**
 * Instantiate by `var xmodem = require('xmodem');`
 * @class
 * @classdesc XMODEM Protocol in JavaScript
 * @name Xmodem
 * @license BSD-2-Clause
 */class Ue extends A{constructor(){super(...arguments),t(this,"log",{info:e=>{},warn:e=>{},error:e=>{},debug:e=>{}}),t(this,"SOH",1),t(this,"STX",2),t(this,"EOT",4),t(this,"ACK",6),t(this,"NAK",21),t(this,"CAN",24),t(this,"FILLER",26),t(this,"CRC_MODE",67),t(this,"receive_interval_timer",!1),t(this,"XMODEM_MAX_TIMEOUTS",5),t(this,"XMODEM_MAX_ERRORS",10),t(this,"XMODEM_CRC_ATTEMPTS",3),t(this,"XMODEM_OP_MODE","crc"),t(this,"XMODEM_START_BLOCK",1),t(this,"timeout_seconds",10),t(this,"block_size",1024)}static get VERSION(){return require("../../../package.json").version}async send(e,t,a,l){this.log.info("Bytes to send : "+a.length),await this.sendLoop(e,t,new Uint8Array(a),l)}async sendLoop(e,t,a,l){for(var s=this.XMODEM_START_BLOCK,n=[],i=B.Buffer.alloc(this.block_size),o=!1,r=0;r<this.XMODEM_START_BLOCK;r++)n.push("");for(;a.length>0;){for(r=0;r<this.block_size;r++)i[r]=void 0===a[r]?this.FILLER:a[r];a=a.slice(this.block_size),n.push(i),i=B.Buffer.alloc(this.block_size)}for(this.emit("ready",n.length-1);!o;)try{l&&l(s,n.length);const{value:a,done:i}=await e.read();if(a){var c=[...a],d=" ";do{d=c.shift()}while(d===this.CRC_MODE&&c.length>0);if(d===this.CRC_MODE&&s!==this.XMODEM_START_BLOCK)continue;d===this.CRC_MODE&&s===this.XMODEM_START_BLOCK?(this.log.info("[SEND] - received C byte for CRC transfer!"),this.XMODEM_OP_MODE="crc",n.length>s&&(this.emit("start",this.XMODEM_OP_MODE),this.sendBlock(t,s,n[s],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:s}),s++)):d===this.NAK&&s===this.XMODEM_START_BLOCK?(this.log.info("[SEND] - received NAK byte for standard checksum transfer!"),this.XMODEM_OP_MODE="normal",n.length>s&&(this.emit("start",this.XMODEM_OP_MODE),this.sendBlock(t,s,n[s],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:s}),s++)):d===this.ACK&&s>this.XMODEM_START_BLOCK?(this.log.info("ACK RECEIVED"),this.emit("status",{action:"recv",signal:"ACK"}),n.length>s?(this.sendBlock(t,s,n[s],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:s}),s++):n.length===s&&(!1===o?(o=!0,this.log.info("WE HAVE RUN OUT OF STUFF TO SEND, EOT EOT!"),this.emit("status",{action:"send",signal:"EOT"}),t.write(B.Buffer.from([this.EOT]))):(this.log.info("[SEND] - Finished!"),this.emit("stop",0)))):d===this.NAK&&s>this.XMODEM_START_BLOCK?s===n.length&&o?(this.log.info("[SEND] - Resending EOT, because receiver responded with NAK."),this.emit("status",{action:"send",signal:"EOT"}),t.write(B.Buffer.from[this.EOT])):(this.log.info("[SEND] - Packet corruption detected, resending previous block."),this.emit("status",{action:"recv",signal:"NAK"}),s--,n.length>s&&(this.sendBlock(t,s,n[s],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:s}),s++)):(this.log.warn("GOT SOME UNEXPECTED DATA which was not handled properly!"),this.log.warn("===>"),this.log.warn("command : "+d),this.log.warn("value : "+c),this.log.warn("<==="),this.log.warn("blockNumber: "+s))}if(i||o)break}catch(u){}}setIntervalX(e,t,a){var l=0,s=setInterval((function(){++l===a&&(clearInterval(s),this.receive_interval_timer=!1),e()}),t);return s}sendBlock(e,t,a,l){var s=0,n=B.Buffer.concat([B.Buffer.from([this.STX]),B.Buffer.from([t]),B.Buffer.from([255-t]),a]);if(this.log.info("SENDBLOCK! Data length: "+a.length),this.log.info(n),"crc"===l){var i=U.crc16xmodem(a).toString(16);i.length%2==1&&(i="0".concat(i)),2===i.length&&(i="00".concat(i)),n=B.Buffer.concat([n,B.Buffer.from(i,"hex")])}else{for(var o=3;o<n.length;o++)s+=n.readUInt8(o);(s=(s%=256).toString(16)).length%2!=0&&(s="0"+s),n=B.Buffer.concat([n,B.Buffer.from(s,"hex")])}this.log.info("Sending buffer with total length: "+n.length),e.write(n)}receiveBlock(e,t,a,l,s,n){var i,o=a[0],r=parseInt(a[1]),c=parseInt(a[2]),d="crc"===s?2:1;if(o===this.STX){if(r+c!==255)return this.log.error("ERROR: Block integrity check failed!"),void e.write(B.Buffer.from([this.NAK]));if(r===t%256)return(i=a.slice(3,a.length-d)).length!==l?(this.log.error("ERROR: Received block size did not match the expected size. Received: "+i.length+" | Expected: "+l),void e.write(B.Buffer.from([this.NAK]))):(e.write(B.Buffer.from([this.ACK])),void n(i));this.log.error("ERROR: Synch issue! Received: "+r+" Expected: "+t)}else this.log.error("ERROR!")}writeFile(e,t,a){this.log.info("writeFile called");var l=Be.createWriteStream(t);l.once("open",(function(t){this.log.info("File stream opened, buffer length: "+e.length);for(var s=0;s<e.length;s++)l.write(e[s]);l.end(),this.log.info("File written"),a()}))}}class Fe{constructor(){this.port=null,this.writer=null,this.reader=null,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.inputStream=null,this.outputStream=null,this.respq=new F,this.xmodem=new Ue,this.readLoopPromise=null,this.enableReadLoop=!1}async open(e){try{this.port=e,await this.attach(),this.startReadLoop()}catch(t){throw alert(t),this.port=null,t}}async readLoop(){let e="",t=0;for(this.enableReadLoop=!0;this.enableReadLoop;)try{const{value:a,done:l}=await this.reader.read();if(a){e+=this.decoder.decode(a);let l=e.indexOf("\n");for(;l>=0;){let a=e.substr(0,l).replace("\r","");t<2&&(t=a.includes("Bootloader")?0:a.includes("------")?1:a.includes("OK.")?2:3),3===t&&this.respq.push(a),e=e.substr(l+1),l=e.indexOf("\n"),2===t&&(t=3)}}l&&(this.enableReadLoop=!1)}catch(a){break}}async attach(){var e,t;if(await this.port.open({baudRate:115200,dataBits:8,parity:"none",stopBits:1,flowControl:"none",baudrate:115200,databits:8,stopbits:1,rtscts:!1}),null==(null==(e=this.port)?void 0:e.writable))throw new Error("This is not a writable port");if(null==(null==(t=this.port)?void 0:t.readable))throw new Error("This is not a readable port");this.reader=this.port.readable.getReader(),this.writer=this.port.writable.getWriter()}startReadLoop(){this.readLoopPromise=this.readLoop()}async stopReadLoop(){this.enableReadLoop=!1,this.readLoopPromise&&(await this.reader.cancel(),await this.readLoopPromise,this.readLoopPromise=null)}async detach(){await this.stopReadLoop(),await this.writer.releaseLock(),await this.reader.releaseLock(),await this.port.close()}async close(){await this.detach()}ensureOpen(){if(!this.port)throw new Error("port not opened")}async readUntil(e){const t=[];let a="";do{a=await this.respq.pop(),t.push(a)}while(!a.startsWith(e));return t}async readUntilEmpty(){const e=[];let t="";do{t=await this.respq.tryPop(),t&&e.push(t)}while(t);return e}async sendCommand(e){await this.readUntilEmpty(),this.writer.write(this.encoder.encode(e+"\n"))}async sendAndExpect(e,t){return await this.sendCommand(e),await this.readUntil(t)}async sendConfirmAndExpect(e,t){await this.sendCommand(e);(await this.respq.pop()).endsWith("?")&&await this.sendAndExpect("Y",t)}async loaderVersion(){this.ensureOpen();return(await this.sendAndExpect("v","OK."))[0]}async erase(){this.ensureOpen(),await this.sendConfirmAndExpect("E","OK.")}async flash(e,t,a){this.ensureOpen(),t?await this.sendConfirmAndExpect("U","Waiting..."):await this.sendConfirmAndExpect("X","Waiting..."),await this.reader.cancel(),await this.writer.close(),this.writer=this.port.writable.getWriter(),this.reader=this.port.readable.getReader();try{await this.xmodem.send(this.reader,this.writer,e,a)}catch(l){}this.startReadLoop()}}const Ie=b(" Update Firmware Steps "),Pe=p("ol",{class:"mb-4 ol-reset space-y-2 leading-loose"},[p("li",null,"Connect your board to the computer."),p("li",null,[b(" On your board, find "),p("kbd",null,"A"),b(" or "),p("kbd",null,"LDR"),b(" button. If not found, insert a paper clip in the 2 small holes. Images and instructions are found on the "),p("a",{href:"https://www.duelink.com/docs/loader"}," Loader"),b(" page. "),p("span",{class:"font-semibold"},"Keep holding the button down or keep the paper clip in"),b(" and "),p("kbd",null,"RESET"),b(" the board. If you do not have a reset button then "),p("kbd",null,"power cycle"),b(" the module. "),p("ul",{class:"mt-2 ul-reset text-red-600"},[p("li",null," Important! Remember to keep on holding the button or keep the clip in while resetting or power cycling the board. ")]),p("ul",{class:"mt-2 ul-reset text-blue-600"},[p("li",null,"This will put your board in bootloader mode.")])]),p("li",null,[p("kbd",null,"Release"),b(" the button now or "),p("kbd",null,"remove"),b(" the paper clip. ")]),p("li",null,[b(" Click the "),p("kbd",null,"Connect"),b(" button below and select "),p("em",null,"GHI Electronics Loader"),b(". "),p("ul",{class:"mt-2 ul-reset text-blue-600"},[p("li",null,[b(" Go back to first step if you do not see "),p("em",null,"GHI Electronics Loader"),b(". ")])])]),p("li",null,[b("Select the desired firmware and click "),p("kbd",null,"Load"),b(".")]),p("li",null,[b(" Once "),p("span",{class:"font-semibold"},"Loading is complete"),b(", "),p("kbd",null,"RESET"),b(" or "),p("kbd",null,"Power Cycle"),b(" the board. ")])],-1),je={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},$e={class:"flex"},Ne=p("div",{class:"flex-shrink-0"},"[Icon]",-1),Ke={class:"ml-3"},Xe=p("h3",{class:"text-sm font-medium text-red-800"}," An error has occurred ",-1),He={class:"mt-2 text-sm text-red-700"},qe={role:"list",class:"list-disc pl-5 space-y-1"},We=["innerHTML"],Ve={class:"ml-auto pl-3"},Ge={class:"-mx-1.5 -my-1.5"},Ye=[p("span",{class:"sr-only"},"Dismiss",-1),b(" [Icon] ")],Je={key:1},Qe={key:0,class:"grid grid-cols-6 gap-2"},Ze={class:"col-span-4"},et=p("label",{for:"firmware"},"Firmware",-1),tt=p("option",{value:"",disabled:""},"Select",-1),at=["selected","value"],lt={class:"col-span-2"},st=p("label",{for:"version"},"Version",-1),nt=["disabled"],it=["selected","value"],ot={key:1,class:"firmware-progress-box"},rt=[p("div",{class:"w-full"},[p("div",{class:"mb-2 text-sky-600 dark:text-lime-400"},"Erasing..."),p("div",{class:"w-full h-2 bg-slate-300 dark:bg-zinc-700"})],-1)],ct={key:2,class:"firmware-progress-box"},dt={class:"w-full"},ut={class:"mb-2 text-sky-600 dark:text-lime-400"},pt={class:"w-full h-2 bg-slate-300 dark:bg-zinc-700"},ft={key:3,class:"firmware-progress-box"},ht=[p("div",{class:"w-full"},[p("div",{class:"mb-2 text-sky-600 dark:text-lime-400"}," Loading... 100% "),p("div",{class:"w-full h-2 bg-sky-500 dark:bg-lime-500"})],-1)],vt={class:"flex space-x-2"},mt=b(" Update "),gt=b(" Disconnect "),bt=b(" Update "),yt=b(" Disconnect "),wt=b(" Done "),kt=b(" Restart "),xt=b(" Connect "),Ct=b(" Close "),Et={props:{availableFirmware:{type:Object,required:!0},open:Boolean},emits:["close"],setup(e,{emit:t}){const n=e,i=a(""),o=a(""),r=new Fe,f=a(!1),b=a(null),k=a("idle"),x=a(null),C=a(0);let _;const M=s((()=>{var e,t;return(null==(t=null==(e=n.availableFirmware)?void 0:e[i.value])?void 0:t.versions.sort(((e,t)=>t.id-e.id)))||[]}));function D(e){"string"==typeof e&&e.indexOf("No port selected by the user.")>-1||(e.value=e,f.value=!1,_=void 0)}async function L(){if(f.value)return;b.value=null;try{_=await navigator.serial.requestPort({}),await r.open(_),f.value=!0}catch(l){D(l)}const e=await r.sendAndExpect("n","OK."),t=Object.keys(n.availableFirmware),a=t.findIndex((t=>t===e[0].toLowerCase()));a>-1&&(i.value=t[a],o.value="0")}async function S(){if(f.value){b.value=null;try{await r.close(),f.value=!1,_=void 0,k.value="idle"}catch(e){D(e)}}}async function T(){await S(),t("close")}function R(){k.value="idle",i.value="",o.value=""}async function z(){b.value=null,C.value=0,n.availableFirmware[i.value].image||(b.value="Failed to load firmware from the server &mdash; cannot program the device."),k.value="erasing",await r.erase(),k.value="writing",await r.flash(n.availableFirmware[i.value].image,n.availableFirmware[i.value].isGlb,((e,t)=>function(e,t){x.value=e<3?"Erasing":"Loading",C.value=Math.round(e/t*100),C.value>=100&&(k.value="complete")}(e,t)))}return l((()=>o.value),(async e=>{const t=n.availableFirmware[i.value].versions[e].url,a=`download_${await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t)}`;let l=null;const s=await fetch(t);if(s.ok){l=await s.blob();const e=await l.arrayBuffer();await async function(e,t){const a=new FileReader;a.onload=function(t){try{localStorage.setItem(e,t.target.result)}catch(a){a.value="Failed to store firmware image."}},a.readAsDataURL(t)}(a,l),n.availableFirmware[i.value].image=e}else b.value=`Unable to download the firmware (${s.status}).`,n.availableFirmware[i.value].image=null})),(a,l)=>(d(),m(Ae,{open:e.open,"max-width-class":"sm:max-w-xl"},{title:g((()=>[Ie])),buttons:g((()=>[p("div",vt,[f.value?(d(),u(h,{key:0},["idle"===k.value?(d(),u(h,{key:0},[O(le,{disabled:!i.value||!e.availableFirmware[i.value].image,onClick:z},{default:g((()=>[mt])),_:1},8,["disabled"]),O(le,{type:"secondary",onClick:S},{default:g((()=>[gt])),_:1})],64)):w("",!0),"erasing"===k.value||"writing"===k.value?(d(),u(h,{key:1},[O(le,{disabled:""},{default:g((()=>[bt])),_:1}),O(le,{disabled:"",type:"secondary"},{default:g((()=>[yt])),_:1})],64)):"complete"===k.value?(d(),u(h,{key:2},[O(le,{onClick:T},{default:g((()=>[wt])),_:1}),O(le,{type:"secondary",onClick:R},{default:g((()=>[kt])),_:1})],64)):w("",!0)],64)):(d(),u(h,{key:1},[O(le,{onClick:L},{default:g((()=>[xt])),_:1}),O(le,{type:"secondary",onClick:l[3]||(l[3]=e=>t("close"))},{default:g((()=>[Ct])),_:1})],64))])])),default:g((()=>[Pe,b.value?(d(),u("div",je,[p("div",$e,[Ne,p("div",Ke,[Xe,p("div",He,[p("ul",qe,[p("li",{innerHTML:b.value},null,8,We)])])]),p("div",Ve,[p("div",Ge,[p("button",{onClick:l[0]||(l[0]=e=>b.value=null),type:"button",class:"inline-flex bg-red-50 rounded-md p-1.5 text-red-500 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-red-50 focus:ring-red-600"},Ye)])])])])):w("",!0),f.value?(d(),u("div",Je,["idle"===k.value?(d(),u("div",Qe,[p("div",Ze,[et,c(p("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>i.value=e),id:"firmware",class:"mt-2"},[tt,(d(!0),u(h,null,v(e.availableFirmware,((e,t)=>(d(),u("option",{key:t,selected:t===i.value,value:t},y(e.name)+" ("+y(e.boards.map((e=>e.name)).join(", "))+") ",9,at)))),128))],512),[[I,i.value]])]),p("div",lt,[st,c(p("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>o.value=e),disabled:!i.value,id:"version",class:"mt-2"},[(d(!0),u(h,null,v(E(M),((e,t)=>(d(),u("option",{key:t,selected:t===o.value,value:t},y(e.name),9,it)))),128))],8,nt),[[I,o.value]])])])):"erasing"===k.value?(d(),u("div",ot,rt)):"writing"===k.value?(d(),u("div",ct,[p("div",dt,[p("div",ut," Loading... "+y(C.value)+"% ",1),p("div",pt,[p("div",{class:"h-2 bg-sky-500 dark:bg-lime-500",style:P(`width:${C.value}%`)},null,4)])])])):"complete"===k.value?(d(),u("div",ft,ht)):w("",!0)])):w("",!0)])),_:1},8,["open"]))}},_t=b(" Firmware Update Steps "),Mt=p("ol",{class:"mb-4 ol-reset space-y-2 leading-loose"},[p("li",null,"Connect your board to the computer."),p("li",null,[b(" On your board, find "),p("kbd",null,"A"),b(" or "),p("kbd",null,"LDR"),b(" button. If not found, insert a paper clip in the 2 small holes. Images and instructions are found on the "),p("a",{href:"https://www.duelink.com/docs/loader"}," Loader"),b(" page. "),p("span",{class:"font-semibold"},"Keep holding the button down or keep the paper clip in"),b(" and "),p("kbd",null,"RESET"),b(" the board. If you do not have a reset button then "),p("kbd",null,"power cycle"),b(" the module. "),p("ul",{class:"mt-2 ul-reset text-red-600"},[p("li",null," Important! Remember to keep on holding the button or keep the clip in while resetting or power cycling the board. ")]),p("ul",{class:"mt-2 ul-reset text-blue-600"},[p("li",null,"This will put your board in loader mode.")])]),p("li",null,[p("kbd",null,"Release"),b(" the button now or "),p("kbd",null,"remove"),b(" the paper clip. ")]),p("li",null,[b(" Click the "),p("kbd",null,"Connect"),b(" button below and select "),p("kbd",null,[p("em",null,"DFU in FS mode")]),b(". "),p("ul",{class:"mt-2 ul-reset text-blue-600"},[p("li",null,[b(" Go back to first step if you do not see "),p("kbd",null,[p("em",null,"DFU in FS mode")]),b(". ")])])]),p("li",null,[b("Select the desired firmware and click "),p("kbd",null,"Load"),b(".")]),p("li",null,[b(" Once "),p("span",{class:"font-semibold"},"Loading is complete"),b(", "),p("kbd",null,"RESET"),b(" or "),p("kbd",null,"Power Cycle"),b(" the board. ")])],-1),Ot={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Dt={class:"flex"},Lt=p("div",{class:"flex-shrink-0"},"[Icon]",-1),St={class:"ml-3"},Tt=p("h3",{class:"text-sm font-medium text-red-800"}," An error has occurred ",-1),Rt={class:"mt-2 text-sm text-red-700"},zt={role:"list",class:"list-disc pl-5 space-y-1"},At=["innerHTML"],Bt={class:"ml-auto pl-3"},Ut={class:"-mx-1.5 -my-1.5"},Ft=[p("span",{class:"sr-only"},"Dismiss",-1),b(" [Icon] ")],It={key:1},Pt={key:0,class:"grid grid-cols-6 gap-2"},jt={class:"col-span-4"},$t=p("label",{for:"dfu"},"Firmware",-1),Nt=p("option",{value:"",disabled:""},"Select",-1),Kt=["selected","value"],Xt={class:"col-span-2"},Ht=p("label",{for:"version"},"Version",-1),qt=["disabled"],Wt=["selected","value"],Vt={key:1,class:"firmware-progress-box"},Gt={class:"w-full"},Yt={class:"mb-2 text-sky-600 dark:text-lime-400"},Jt={class:"w-full h-2 bg-slate-300 dark:bg-zinc-700"},Qt={key:2,class:"firmware-progress-box"},Zt={class:"w-full"},ea={class:"mb-2 text-sky-600 dark:text-lime-400"},ta={class:"w-full h-2 bg-slate-300 dark:bg-zinc-700"},aa={key:3,class:"firmware-progress-box"},la=[p("div",{class:"w-full"},[p("div",{class:"mb-2 text-sky-600 dark:text-lime-400"}," Updated... 100% "),p("div",{class:"w-full h-2 bg-sky-500 dark:bg-lime-500"})],-1)],sa={class:"flex space-x-2"},na=b(" Load "),ia=b(" Disconnect "),oa=b(" Load "),ra=b(" Disconnect "),ca=b(" Done "),da=b(" Restart "),ua=b(" Connect "),pa=b(" Close "),fa={props:{availableDfu:{type:Object,required:!0},open:Boolean},emits:["close"],setup(e,{emit:t}){const n=e,i=a(""),o=a(""),r=a(!1),f=a(null),b=a("idle"),k=a(null),x=a(0);let C;const _=s((()=>{var e,t;return(null==(t=null==(e=n.availableDfu)?void 0:e[i.value])?void 0:t.versions.sort(((e,t)=>t.id-e.id)))||[]}));function M(e){"string"==typeof e&&e.indexOf("No port selected by the user.")>-1||(e.value=e,r.value=!1,C=void 0)}async function D(){if(r.value)return;f.value=null;try{await async function(){try{r.value=!1,F=await navigator.usb.requestDevice({filters:[{vendorId:1155}]}),await F.open(),F.configuration||await F.selectConfiguration(1),await F.claimInterface(0),U("Device connected; DFU interface claimed."),r.value=!0}catch(e){e.value="Connection error: "+e,U("Connection error: "+e),r.value=!1}}()}catch(a){M(a)}const e=Object.keys(n.availableDfu),t=e.findIndex((e=>"DUELink"===e));t>-1&&(i.value=e[t],o.value=0)}async function L(){if(r.value){f.value=null;try{await ghiLoader.close(),r.value=!1,C=void 0,b.value="idle"}catch(e){M(e)}}}async function S(){await L(),t("close")}function T(e,t){k.value=e<3?"Erasing":"Loading",x.value=Math.round(e/t*100),x.value>=100&&(b.value="complete")}function R(){b.value="idle",i.value="DUELink",o.value=""}async function z(){f.value=null,x.value=0,n.availableDfu[i.value].image||(f.value="Failed to load firmware from the server &mdash; cannot program the device."),async function(e){try{0!==(await $()).status&&(U("Clearing DFU error status..."),await F.controlTransferOut({requestType:"class",recipient:"interface",request:4,value:0,index:0}),await N(100));const a=e.byteLength;U(`Firmware size: ${a} bytes`),await async function(e){b.value="erasing";const t=Math.ceil(e/A);U(`Erasing ${t} flash page(s) starting at 0x${B.toString(16)}...`);for(let a=0;a<t;a++){const e=B+a*A,l=new Uint8Array(5);l[0]=65,l[1]=255&e,l[2]=e>>8&255,l[3]=e>>16&255,l[4]=e>>24&255,U(`Erasing flash page at address 0x${e.toString(16)}`),await j(0,l),await K(),T(a,t)}U("Erase complete.")}(a),b.value="writing";let l=new Uint8Array(5);l[0]=33,l[1]=0,l[2]=0,l[3]=0,l[4]=8,U(`Sending address command block (block 0): write pointer set to 0x${B.toString(16)}`),await j(0,l),await K();let s=0,n=2;for(;s<a;){const t=e.slice(s,s+1024);U(`Transferring block ${n} (size: ${t.byteLength} bytes)...`),await j(n,t),await K(),s+=t.byteLength,n++,T(s,a)}U(`Sending final zero-length packet (block ${n}) to complete DFU transfer...`);try{await j(n,new ArrayBuffer(0))}catch(t){U(`Finalization error (expected during manifest/reset): ${t.message}`)}U("Firmware update complete. The device should now program the firmware and reset."),b.value="complete"}catch(a){U("Firmware upgrade failed: "+a.message),b.value="complete"}}(n.availableDfu[i.value].image)}l([i,o],(async()=>{const e=_.value[o.value].url,t=`download_${await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(e)}`;let a=null;const l=await fetch(e);if(l.ok){a=await l.blob();const e=await a.arrayBuffer();await async function(e,t){const a=new FileReader;a.onload=function(t){try{localStorage.setItem(e,t.target.result)}catch(a){a.value="Failed to store firmware image."}},a.readAsDataURL(t)}(t,a),n.availableDfu[i.value].image=e}else f.value=`Unable to download the firmware (${l.status}).`,n.availableDfu[i.value].image=null}));const A=2048,B=134217728;function U(e){}let F;async function j(e,t){const a=await F.controlTransferOut({requestType:"class",recipient:"interface",request:1,value:e,index:0},t);if("ok"!==a.status)throw new Error("DNLOAD transfer failed at block "+e);return a}async function $(){const e=await F.controlTransferIn({requestType:"class",recipient:"interface",request:3,value:0,index:0},6);if("ok"===e.status&&e.data&&6===e.data.byteLength){const t=new DataView(e.data.buffer);return{status:t.getUint8(0),pollTimeout:t.getUint8(1)|t.getUint8(2)<<8|t.getUint8(3)<<16,state:t.getUint8(4),iString:t.getUint8(5)}}throw new Error("Failed to read DFU status.")}function N(e){return new Promise((t=>setTimeout(t,e)))}async function K(){for(;;){const e=await $();if(e.state,e.pollTimeout,5===e.state||2===e.state)break;await N(e.pollTimeout)}}return(a,l)=>(d(),m(Ae,{open:e.open,"max-width-class":"sm:max-w-xl"},{title:g((()=>[_t])),buttons:g((()=>[p("div",sa,[r.value?(d(),u(h,{key:0},["idle"===b.value?(d(),u(h,{key:0},[O(le,{disabled:!i.value,onClick:z},{default:g((()=>[na])),_:1},8,["disabled"]),O(le,{type:"secondary",onClick:L},{default:g((()=>[ia])),_:1})],64)):w("",!0),"erasing"===b.value||"writing"===b.value?(d(),u(h,{key:1},[O(le,{disabled:""},{default:g((()=>[oa])),_:1}),O(le,{disabled:"",type:"secondary"},{default:g((()=>[ra])),_:1})],64)):"complete"===b.value?(d(),u(h,{key:2},[O(le,{onClick:S},{default:g((()=>[ca])),_:1}),O(le,{type:"secondary",onClick:R},{default:g((()=>[da])),_:1})],64)):w("",!0)],64)):(d(),u(h,{key:1},[O(le,{onClick:D},{default:g((()=>[ua])),_:1}),O(le,{type:"secondary",onClick:l[3]||(l[3]=e=>t("close"))},{default:g((()=>[pa])),_:1})],64))])])),default:g((()=>[Mt,f.value?(d(),u("div",Ot,[p("div",Dt,[Lt,p("div",St,[Tt,p("div",Rt,[p("ul",zt,[p("li",{innerHTML:f.value},null,8,At)])])]),p("div",Bt,[p("div",Ut,[p("button",{onClick:l[0]||(l[0]=e=>f.value=null),type:"button",class:"inline-flex bg-red-50 rounded-md p-1.5 text-red-500 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-red-50 focus:ring-red-600"},Ft)])])])])):w("",!0),r.value?(d(),u("div",It,["idle"===b.value?(d(),u("div",Pt,[p("div",jt,[$t,c(p("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>i.value=e),id:"dfu",class:"mt-2"},[Nt,(d(!0),u(h,null,v(e.availableDfu,((e,t)=>(d(),u("option",{key:t,selected:t===i.value,value:t},y(e.name)+" ("+y(e.boards.map((e=>e.name)).join(", "))+") ",9,Kt)))),128))],512),[[I,i.value]])]),p("div",Xt,[Ht,c(p("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>o.value=e),disabled:!i.value,id:"version",class:"mt-2"},[(d(!0),u(h,null,v(E(_),((e,t)=>(d(),u("option",{key:t,selected:t===o.value,value:t},y(e.name),9,Wt)))),128))],8,qt),[[I,o.value]])])])):"erasing"===b.value?(d(),u("div",Vt,[p("div",Gt,[p("div",Yt," Erasing... "+y(x.value)+"% ",1),p("div",Jt,[p("div",{class:"h-2 bg-sky-500 dark:bg-lime-500",style:P(`width:${x.value}%`)},null,4)])])])):"writing"===b.value?(d(),u("div",Qt,[p("div",Zt,[p("div",ea," Writing... "+y(x.value)+"% ",1),p("div",ta,[p("div",{class:"h-2 bg-sky-500 dark:bg-lime-500",style:P(`width:${x.value}%`)},null,4)])])])):"complete"===b.value?(d(),u("div",aa,la)):w("",!0)])):w("",!0)])),_:1},8,["open"]))}},ha={class:"flex-1 flex items-center justify-between"},va={class:"flex items-center space-x-2"},ma={props:{autoScroll:Boolean,closed:Boolean,title:String},setup(e,{expose:t}){const l=e;t({open:function(){r.value=!0}});const s={slot:null};let i=null;const r=a(!l.closed);return l.autoScroll&&(o((()=>{n((()=>{s.slot&&(i=new MutationObserver((()=>s.slot.scrollTop=s.slot.scrollHeight)),i.observe(s.slot,{attributes:!1,childList:!0,characterData:!0,subtree:!0}))}))})),j((()=>i.disconnect()))),(t,a)=>(d(),u("div",null,[p("div",{class:"panel-bar flex items-center px-4 py-2 cursor-pointer select-none transition duration-150 ease-in-out",onClick:a[0]||(a[0]=e=>r.value=!r.value)},[p("div",ha,[p("div",va,[p("i",{class:M(["fas fa-fw",r.value?"fa-angle-down":"fa-angle-right"])},null,2),p("span",null,y(e.title),1)]),f(t.$slots,"buttons")])]),c(p("div",{ref:e=>s.slot=e,class:"panel-content max-h-[380px] overflow-y-auto"},[f(t.$slots,"default")],512),[[_,r.value]])]))}},ga=p("i",{class:"fas fa-fw fa-eraser"},null,-1),ba={class:"p-2 whitespace-pre-wrap text-sm font-mono text-slate-700 dark:text-zinc-300"},ya={props:{log:String},setup(e){const t=e,a=s((()=>t.log.split("\n").map((e=>{for(;e&&(e.startsWith("$")||e.startsWith(">")||e.startsWith("&"));)e=e.substring(1);return e})).filter((e=>e)).join("\n")));return(e,t)=>(d(),m(ma,{"auto-scroll":"",title:"Log"},{buttons:g((()=>[O(le,{disabled:!E(a).length,"data-tippy-content":"Clear",onClick:t[0]||(t[0]=k((t=>e.$emit("update:log","")),["stop"]))},{default:g((()=>[ga])),_:1},8,["disabled"])])),default:g((()=>[p("div",ba,y(E(a)),1)])),_:1}))}},wa={class:"p-2 whitespace-pre-wrap"},ka={key:0,class:"p-2 text-sm divide-y divide-slate-300 dark:divide-zinc-700"},xa=p("div",{class:"px-2 py-1 grid grid-cols-12 font-medium"},[p("div",{class:"col-span-1"}),p("div",{class:"col-span-4"},"Region"),p("div",{class:"col-span-4 text-right"},"Used"),p("div",{class:"col-span-3 text-right"},"Total")],-1),Ca=["onClick"],Ea={class:"col-span-1"},_a={key:0,class:"fas fa-fw fa-angle-right"},Ma={class:"col-span-4"},Oa={class:"col-span-4 text-right"},Da={class:"col-span-3 text-right"},La={key:1,class:"mt-2 px-12 flex space-x-4"},Sa=b(" Add Region "),Ta=b(" List All "),Ra=b(" Erase All "),za={props:{regions:{type:Array,default:()=>[]}},setup:e=>(t,a)=>(d(),m(ma,{title:"Regions"},{default:g((()=>[p("div",wa,[e.regions.length?(d(),u("div",ka,[xa,(d(!0),u(h,null,v(e.regions,(e=>(d(),u("div",{class:M([(null==e?void 0:e.current)?"font-medium bg-sky-100 text-sky-700 dark:bg-sky-950 dark:text-sky-200":"cursor-pointer hover:bg-slate-100 dark:hover:bg-zinc-900","px-2 py-1 grid grid-cols-12"]),onClick:a=>(null==e?void 0:e.current)?void 0:t.$emit("region",e.index)},[p("div",Ea,[(null==e?void 0:e.current)?(d(),u("i",_a)):w("",!0)]),p("div",Ma,y((null==e?void 0:e.index)+" - "+(0===(null==e?void 0:e.index)?"Driver":"User")),1),p("div",Oa,y(null==e?void 0:e.used),1),p("div",Da,y(null==e?void 0:e.total),1)],10,Ca)))),256))])):w("",!0),e.regions.length?(d(),u("div",La,[O(le,{disabled:e.regions.length>=2,class:"w-full","data-tippy-content":"Clear",type:"secondary",onClick:a[0]||(a[0]=k((e=>t.$emit("region",1)),["stop"]))},{default:g((()=>[Sa])),_:1},8,["disabled"]),O(le,{disabled:e.regions.every((e=>0===e.used)),class:"w-full","data-tippy-content":"Clear",type:"secondary",onClick:a[1]||(a[1]=k((e=>t.$emit("list-all")),["stop"]))},{default:g((()=>[Ta])),_:1},8,["disabled"]),O(le,{disabled:!e.regions.length||1===e.regions.length&&0===e.regions[0].index&&0===e.regions[0].used,class:"w-full","data-tippy-content":"Clear",type:"secondary",onClick:a[2]||(a[2]=k((e=>t.$emit("new-all")),["stop"]))},{default:g((()=>[Ra])),_:1},8,["disabled"])])):w("",!0)])])),_:1}))},Aa=p("i",{class:"fas fa-fw fa-eraser"},null,-1),Ba={class:"p-2 whitespace-pre-wrap text-sm"},Ua=["innerHTML"],Fa={key:1,class:"flex space-x-2"},Ia={class:"text-sky-600 dark:text-lime-200"},Pa=["innerHTML"],ja={props:{history:Array},setup:e=>(t,a)=>(d(),m(ma,{"auto-scroll":"",title:"History"},{buttons:g((()=>[O(le,{disabled:!e.history.length,"data-tippy-content":"Clear",onClick:a[0]||(a[0]=k((e=>t.$emit("update:history",[])),["stop"]))},{default:g((()=>[Aa])),_:1},8,["disabled"])])),default:g((()=>[p("div",Ba,[(d(!0),u(h,null,v(e.history,(e=>(d(),u(h,null,[(null==e?void 0:e.error)?(d(),u("div",{key:0,innerHTML:e.error,class:"text-red-600 dark:text-red-400"},null,8,Ua)):(null==e?void 0:e.event)?(d(),u("div",Fa,[p("div",Ia,"["+y(e.date.toLocaleTimeString())+"]",1),p("div",{innerHTML:e.event,class:"flex-1"},null,8,Pa)])):w("",!0)],64)))),256))])])),_:1}))},$a={class:"p-2 text-sm divide-y divide-slate-300 dark:divide-zinc-700"},Na={class:"px-2 py-1 flex justify-between"},Ka=p("div",{class:"font-medium"},"Console",-1),Xa={class:"px-2 py-1 flex justify-between"},Ha=p("div",{class:"font-medium"},"Device",-1),qa={class:"px-2 py-1 flex justify-between"},Wa=p("div",{class:"font-medium"},"Device firmware",-1),Va={class:"px-2 py-1 flex justify-between"},Ga=p("div",{class:"font-medium"},"Latest firmware",-1),Ya={key:0,class:"px-4 py-2 font-medium bg-yellow-200 dark:text-zinc-900"},Ja=[p("i",{class:"fas fa-fw fa-triangle-exclamation mr-1"},null,-1),b(" Please update to the latest firmware. ")],Qa=p("div",{class:"flex justify-end px-4"},[p("a",{class:"mt-4 inline-block w-full sm:w-auto text-center sm:text-left px-4 py-2 font-medium rounded transition bg-slate-300 hover:bg-slate-500 text-slate-600 hover:text-slate-50 dark:bg-zinc-600 dark:hover:bg-zinc-300 dark:text-zinc-100 dark:hover:text-zinc-950",href:"https://github.com/ghi-electronics/due-console/issues/",target:"_blank"},[p("i",{class:"fas fa-fw fa-arrow-up-right-from-square mr-1"}),b(" Report Issue ")])],-1),Za={props:{availableDfu:Object,version:String},setup(e){const t=e,a=s((()=>"D")),l=s((()=>t.version?t.version:null)),n=s((()=>Object.values(t.availableDfu).find((e=>((null==e?void 0:e.boards)||[]).find((e=>e.id===a.value)))))),i=s((()=>{if(n.value){const e=n.value.boards.find((e=>e.id===a.value));if(e)return e.name}return null})),o=s((()=>n.value&&l.value?`${l.value}`:null)),r=s((()=>{if(Object.values(t.availableDfu).length){const e=Object.keys(t.availableDfu)[0],a=Math.max(...t.availableDfu[e].versions.map((e=>e.id)));return`${t.availableDfu[e].versions.find((e=>e.id===a)).name}`}return null})),c=s((()=>{const e=Number(o.value.replace(/([^.\d]+)/gm,"")),t=Number(r.value.replace(/([^.\d]+)/gm,""));return!isNaN(e)&&!isNaN(t)&&e===t}));return(e,t)=>(d(),u(h,null,[O(ma,{title:"About"},{default:g((()=>[p("div",$a,[p("div",Na,[Ka,p("div",null," v"+y(E("1.2.0")),1)]),p("div",Xa,[Ha,p("div",null,y(E(i)?E(i):"..."),1)]),p("div",qa,[Wa,p("div",null,y(E(o)?E(o):"..."),1)]),p("div",Va,[Ga,p("div",null,y(E(r)?E(r):"..."),1)])])])),_:1}),null===E(o)||null===E(r)||E(c)?w("",!0):(d(),u("div",Ya,Ja)),Qa],64))}},el=b(" List All "),tl={id:"list-all-editor",class:"mt-4"},al={class:"flex space-x-2"},ll=b(" Close "),sl={props:{code:String,language:String,open:Boolean,textSize:Number,theme:String},emits:["close"],setup(e,{emit:t}){const a=e;function l(e){e.setShowPrintMargin(!1),e.setOptions({fontSize:a.textSize+"px"}),e.setReadOnly(!0),e.setHighlightActiveLine(!1)}return(a,s)=>(d(),m(Ae,{open:e.open,"max-width-class":"sm:max-w-2xl"},{title:g((()=>[el])),default:g((()=>[p("div",tl,[O(E(N),{lang:e.language,theme:"dark"===e.theme?"tomorrow_night_bright":"crimson_editor",value:e.code,"onUpdate:value":s[0]||(s[0]=e=>$(code)?code.value=e:null),style:{height:"300px"},onInit:l},null,8,["lang","theme","value"])])])),buttons:g((()=>[p("div",al,[O(le,{type:"secondary",onClick:s[1]||(s[1]=e=>t("close"))},{default:g((()=>[ll])),_:1})])])),_:1},8,["open"]))}},nl=b(" Erase All "),il=p("p",null,"Please confirm you want to erase all regions and code.",-1),ol={class:"flex space-x-2"},rl=b(" Confirm "),cl=b(" Cancel "),dl={props:{open:Boolean},setup:e=>(t,a)=>(d(),m(Ae,{open:e.open,"max-width-class":"sm:max-w-xl"},{title:g((()=>[nl])),buttons:g((()=>[p("div",ol,[O(le,{type:"primary",onClick:a[0]||(a[0]=e=>t.$emit("confirm"))},{default:g((()=>[rl])),_:1}),O(le,{type:"secondary",onClick:a[1]||(a[1]=e=>t.$emit("close"))},{default:g((()=>[cl])),_:1})])])),default:g((()=>[il])),_:1},8,["open"]))},ul={id:"progress-bar"},pl={class:"min-h-screen flex flex-col space-y-0.5"},fl={class:"flex-1 flex flex-col space-y-0.5 sm:space-y-0 sm:flex-row sm:space-x-0.5"},hl={id:"editor",class:"flex-1 p-2 flex flex-col"},vl={id:"direct-bar",class:"p-2 sm:pl-[42px] flex space-x-2"},ml={class:"flex-1"},gl={class:"relative"},bl=[p("i",{class:"fas fa-fw fa-xmark"},null,-1)],yl=["onKeyup"],wl=p("i",{class:"fas fa-fw fa-arrow-right"},null,-1),kl={id:"side-bar",class:"sm:w-1/2 lg:w-1/3 p-2 space-y-0.5"},xl=p("div",{id:"spacer"},null,-1),Cl=b(" Heads up! "),El=p("div",null,"You already have code in the editor.",-1),_l=p("div",null,"Do you want to replace it?",-1),Ml={class:"flex space-x-2"},Ol=b(" Yes "),Dl=b(" No "),Ll=b(" Download "),Sl=p("div",{class:"mb-2"},"What would you like to name the file?",-1),Tl=p("label",{for:"filename"},"File name",-1),Rl={class:"flex space-x-2"},zl=b(" Download "),Al=b(" Cancel "),Bl={setup(e){const t={editor:null,filename:null,input:null,progress:null},i=K({}),r=K({}),f=a(""),v=a(""),m=a(""),b=a(1),y=a(1),w=a(""),k=a("python"),x=a("light"),C=a(16),_=W();_.on("erased",(()=>{f.value=""})),_.on("listAllResult",(e=>{1===e.result.length&&">"===e.result[0]&&(e.result=[]),A.code=e.result.join("\n"),A.open=!0})),_.on("regionSelected",(()=>ae(null)));const D=Q(t,_),L={animation:"fade",appendTo:document.body,interactive:!0,placement:"bottom",theme:"light"},S=K({lines:[],list:!1,open:!1,target:null,async yes(){this.list&&(this.list=!1,D.list((e=>{e.length&&(f.value=e.join("\n"))}))),this.lines.length&&(f.value=this.lines.join("\n"),this.lines=[]),this.open=!1,this.fixTippy()},async no(){this.list&&(this.list=!1,D.list()),this.open=!1,this.fixTippy()},fixTippy(){var e;(null==(e=null==this?void 0:this.target)?void 0:e._tippy)&&(this.target._tippy.destroy(),setTimeout((()=>{L.theme=x.value,X(this.target,L)}),200))}}),T=K({open:!1,toggleCounter:0,start(){D.isConnected&&D.disconnect(),this.toggleCounter++}}),R=K({open:!1,toggleCounter:0,start(){D.isConnected&&D.disconnect(),this.toggleCounter++}}),z=K({open:!1,start(){this.open=!0,n((()=>t.filename.focus()))},download(){!function(e){if(!f.value.length||!e.length)return;const t=new Blob([f.value],{type:"text/csv"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download=`${e}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}(w.value),this.cancel()},cancel(){w.value="",this.open=!1}}),A=K({open:!1,code:null}),B=K({open:!1});let U=null,F=[];const I=s((()=>f.value.length>0)),P=s((()=>""!==f.value&&f.value===m.value&&!D.isPlaying.value)),j=s((()=>f.value.length>0&&f.value!==m.value)),$=s((()=>!D.isStopped.value)),V=s((()=>!D.isConnected.value||D.isBusy.value||D.isTalking.value));function G(e){1===R.toggleCounter?(R.open=!0,R.toggleCounter=0):R.open=!1,1===T.toggleCounter?(T.open=!0,T.toggleCounter=0):T.open=!1}async function Y(e){f.value?(S.lines=e.slice(0),S.open=!0):f.value=e.join("\n")}function J(e){e.setShowPrintMargin(!1),e.setOptions({fontSize:C.value+"px"}),e.session.selection.on("changeCursor",(()=>{const t=e.getCursorPosition();b.value=t.row+1,y.value=t.column+1})),U=e}function Z(e){f.value?(S.lines=e.slice(0),S.open=!0):f.value=e.join("\n")}async function ee(){m.value=f.value,D.record(f.value)}async function te(){D.execute(v.value.replace(/\t/gm," "))}async function ae(e){f.value?(S.target=e,S.list=!0,S.open=!0):D.list((e=>{const t=e.join("\n");f.value!==t&&(f.value=t,m.value=t)}))}function se(e,t=!1){e&&n((()=>{e._tippy?(e._tippy.setContent(e.getAttribute("data-tippy-content")),t&&e._tippy.show()):(L.theme=x.value,X([e],L))}))}function ne(){F.forEach((e=>e.setProps({theme:x.value})))}function ie(){C.value+=4,C.value>40&&(C.value=40),U.setOptions({fontSize:C.value+"px"})}function oe(){C.value-=4,C.value<12&&(C.value=12),U.setOptions({fontSize:C.value+"px"})}return l((()=>D.isConnected),(e=>{const t=document.getElementById("plugBtn");t&&se(t),e||(m.value="")})),("dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(x.value="dark",L.theme="dark"),async function(){try{const e=await fetch("/legacy.json"),t=await e.json();Object.keys(t).forEach((e=>{i[e]=t[e],i[e].isGlb=!1,i[e].image=null}))}catch(e){}}(),async function(){try{const e=await fetch("/dfu.json"),t=await e.json();Object.keys(t).forEach((e=>{r[e]=t[e],r[e].isGlb=!1,r[e].image=null}))}catch(e){}}(),o((()=>{F=X("[data-tippy-content]",L),window.onbeforeunload=function(){if(f.value)return!1},document.addEventListener("click",G)})),(e,a)=>(d(),u(h,null,[p("div",ul,[p("div",{ref:e=>t.progress=e,class:"h-1 bg-sky-500 dark:bg-lime-500 transition duration-1000 ease-linear opacity-0"},null,512)]),p("div",pl,[O(de,{theme:x.value,"onUpdate:theme":[a[0]||(a[0]=e=>x.value=e),ne],onDemo:Y,onFirmware:a[1]||(a[1]=e=>E(T).start()),onDfu:a[2]||(a[2]=e=>E(R).start()),onUpdateTippy:se},null,8,["theme"]),O(ke,{"can-download":E(I),"can-list":!0,"can-load":!0,"can-play":E(P),"can-record":E(j),"can-stop":E($),"can-text-size-plus":C.value<40,"can-text-size-minus":C.value>12,"is-busy":E(D).isBusy.value,"is-connected":E(D).isConnected.value,"is-talking":E(D).isTalking.value,onConnect:a[3]||(a[3]=e=>E(D).connect()),onDisconnect:a[4]||(a[4]=e=>E(D).disconnect()),onDownload:a[5]||(a[5]=e=>E(z).start()),onPlay:a[6]||(a[6]=e=>E(D).play()),onStop:a[7]||(a[7]=e=>E(D).stop()),onRecord:ee,onList:ae,onLoad:Z,onTextSizePlus:ie,onTextSizeMinus:oe},null,8,["can-download","can-play","can-record","can-stop","can-text-size-plus","can-text-size-minus","is-busy","is-connected","is-talking"]),p("div",fl,[p("div",hl,[O(E(N),{value:f.value,"onUpdate:value":a[8]||(a[8]=e=>f.value=e),lang:k.value,ref:e=>t.editor=e,theme:"dark"===x.value?"tomorrow_night_bright":"crimson_editor",class:"flex-1",onInit:J},null,8,["value","lang","theme"]),p("div",vl,[p("div",ml,[p("div",gl,[p("div",{class:"absolute right-0 inset-y-0 p-1 flex items-center justify-center rounded-r-md",onClick:a[9]||(a[9]=e=>{v.value="",t.input.focus()})},[p("div",{class:M([[v.value.length?"text-slate-400 hover:text-slate-900 dark:text-zinc-600 dark:hover:text-zinc-100":"hidden"],"flex items-center justify-center w-8 h-full rounded-md cursor-pointer hover:bg-slate-100 dark:hover:bg-zinc-900"])},bl,2)]),c(p("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>v.value=e),ref:e=>t.input=e,placeholder:"Code to run immediately...",type:"text",onKeyup:q(te,["enter"])},null,40,yl),[[H,v.value]])])]),O(le,{disabled:E(V),"data-tippy-content":"Execute",onClick:te},{default:g((()=>[wl])),_:1},8,["disabled"])])]),p("div",kl,[O(za,{regions:E(D).regions.value,onListAll:a[11]||(a[11]=e=>E(D).listAll()),onNewAll:a[12]||(a[12]=e=>E(B).open=!0),onRegion:a[13]||(a[13]=e=>E(D).region(e))},null,8,["regions"]),O(ya,{log:E(D).log.value,"onUpdate:log":a[14]||(a[14]=e=>E(D).log.value=e)},null,8,["log"]),O(ja,{history:E(D).history.value,"onUpdate:history":a[15]||(a[15]=e=>E(D).history.value=e),closed:""},null,8,["history"]),O(Za,{"available-dfu":E(r),version:E(D).version.value},null,8,["available-dfu","version"])])]),xl,O(xe)]),O(Ae,{open:E(S).open},{title:g((()=>[Cl])),buttons:g((()=>[p("div",Ml,[O(le,{class:"w-full",onClick:a[16]||(a[16]=e=>E(S).yes())},{default:g((()=>[Ol])),_:1}),O(le,{class:"w-full",type:"secondary",onClick:a[17]||(a[17]=e=>E(S).no())},{default:g((()=>[Dl])),_:1})])])),default:g((()=>[El,_l])),_:1},8,["open"]),O(Ae,{open:E(z).open},{title:g((()=>[Ll])),buttons:g((()=>[p("div",Rl,[O(le,{disabled:0===w.value.length,class:"w-full",onClick:a[19]||(a[19]=e=>E(z).download())},{default:g((()=>[zl])),_:1},8,["disabled"]),O(le,{class:"w-full",type:"secondary",onClick:a[20]||(a[20]=e=>E(z).cancel())},{default:g((()=>[Al])),_:1})])])),default:g((()=>[p("div",null,[Sl,Tl,c(p("input",{"onUpdate:modelValue":a[18]||(a[18]=e=>w.value=e),ref:e=>t.filename=e,class:"mt-2",id:"filename",type:"text"},null,512),[[H,w.value]])])])),_:1},8,["open"]),O(Et,{"available-firmware":E(i),open:E(T).open,onClose:a[21]||(a[21]=e=>E(T).open=!1)},null,8,["available-firmware","open"]),O(fa,{"available-dfu":E(r),open:E(R).open,onClose:a[22]||(a[22]=e=>E(R).open=!1)},null,8,["available-dfu","open"]),O(sl,{code:E(A).code,language:k.value,open:E(A).open,"text-size":C.value,theme:x.value,onClose:a[23]||(a[23]=e=>E(A).open=!1)},null,8,["code","language","open","text-size","theme"]),O(dl,{open:E(B).open,onClose:a[24]||(a[24]=e=>E(B).open=!1),onConfirm:a[25]||(a[25]=e=>{E(D).newAll(),E(B).open=!1})},null,8,["open"])],64))}};window.ace=V;const Ul=G(Bl);Ul.use(Y),Ul.mount("#app");
